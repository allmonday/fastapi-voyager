#!/bin/sh
# Git pre-commit hook to run Prettier on staged files

# Get the project root directory
PROJECT_ROOT="$(cd "$(dirname "$0")/../.." && pwd)"
cd "$PROJECT_ROOT" || exit 1

# Check if npx is available
if ! command -v npx >/dev/null 2>&1; then
  echo "Warning: npx not found. Skipping Prettier formatting."
  echo "Please install Node.js and npm to use pre-commit formatting."
  exit 0
fi

echo "Running Prettier on staged files..."

# Check if .prettierignore exists
if [ -f ".prettierignore" ]; then
  echo "Found .prettierignore, applying rules..."
  npx prettier --write . --log-level=warn --ignore-path=.prettierignore
else
  echo "No .prettierignore found, formatting all files..."
  npx prettier --write . --log-level=warn
fi

# Add any newly formatted files to the staging area
git add .

echo "Prettier formatting complete."
